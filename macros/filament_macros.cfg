[gcode_macro FILAMENT_PROFILE]
variable_parameter_FILAMENT_TYPE : "PLA"
description: Set current printing filament parameters
gcode:
  {% if params.FILAMENT_TYPE|default("DEFAULT") == "PLA" %}
    PRINT MSG="Set filament profile : PLA" OUTPUT_TARGET=1
    M221 S93 ; Tunned flow
    SET_PRESSURE_ADVANCE ADVANCE=0.05
    SET_FAN_SPEED FAN=filter_fan SPEED=0.1
  {% elif params.FILAMENT_TYPE|default("DEFAULT") == "PETG" %}
    PRINT MSG="Set filament profile : PETG" OUTPUT_TARGET=1
    M221 S93 ; Tunned flow
    SET_PRESSURE_ADVANCE ADVANCE=0.08
    SET_FAN_SPEED FAN=filter_fan SPEED=0.75
  {% elif params.FILAMENT_TYPE|default("DEFAULT") == "ABS" %}
    PRINT MSG="Set filament profile : ABS" OUTPUT_TARGET=1
    M221 S93 ; Tunned flow
    SET_PRESSURE_ADVANCE ADVANCE=0.04
    SET_FAN_SPEED FAN=filter_fan SPEED=0.3
  {% elif params.FILAMENT_TYPE|default("DEFAULT") == "ASA" %}
    PRINT MSG="Set filament profile : ASA" OUTPUT_TARGET=1
    M221 S93 ; Tunned flow
    SET_PRESSURE_ADVANCE ADVANCE=0.04
    SET_FAN_SPEED FAN=filter_fan SPEED=0.25
  {% elif params.FILAMENT_TYPE|default("DEFAULT") == "PC" %}
    PRINT MSG="Set filament profile : PC" OUTPUT_TARGET=1
    M221 S93 ; Tunned flow
    SET_PRESSURE_ADVANCE ADVANCE=0.067
    SET_FAN_SPEED FAN=filter_fan SPEED=0.0
  {% elif params.FILAMENT_TYPE|default("DEFAULT") == "PC_CF" %}
    PRINT MSG="Set filament profile : PC_CF" OUTPUT_TARGET=1
    M221 S102 ; Tunned flow
    SET_PRESSURE_ADVANCE ADVANCE=0.04
    SET_FAN_SPEED FAN=filter_fan SPEED=0.25
  {% elif params.FILAMENT_TYPE|default("DEFAULT") == "TEST" %}
    PRINT MSG="Set filament profile : TEST" OUTPUT_TARGET=1
    M221 S93 ; Tunned flow
    SET_PRESSURE_ADVANCE ADVANCE=0.05 
    SET_FAN_SPEED FAN=filter_fan SPEED=1.0
  {% else %}
    PRINT MSG="Set filament profile : Default" OUTPUT_TARGET=1
    M221 S93 ; Tunned flow
    SET_PRESSURE_ADVANCE ADVANCE=0.00
    SET_FAN_SPEED FAN=filter_fan SPEED=1.0
  {% endif %}